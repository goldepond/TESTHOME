# 등기부등본 기능 비활성화 가이드

> **작성일:** 2024-11-01  
> **파일:** `lib/screens/home_page.dart`

---

## 🔴 등기부등본 기능 비활성화 완료

등기부등본 조회 기능을 일시적으로 비활성화했습니다. 간단한 플래그로 활성화/비활성화를 전환할 수 있습니다.

---

## 📍 변경 위치

### `lib/screens/home_page.dart` - Line 750-752

```dart
// ========================================
// 🔴 등기부등본 기능 비활성화 플래그
// ========================================
const bool isRegisterFeatureEnabled = false; // true로 변경하면 기능 활성화
```

---

## 🔧 기능 활성화/비활성화 방법

### ❌ 비활성화 (현재 상태)
```dart
const bool isRegisterFeatureEnabled = false;
```

### ✅ 활성화 (필요시)
```dart
const bool isRegisterFeatureEnabled = true;
```

---

## 💡 동작 방식

### 1. 조회 프로세스

```
사용자가 "조회하기" 버튼 클릭
    ↓
주소 검색 완료 확인
    ↓
isRegisterFeatureEnabled 체크
    ↓
┌─────────────────────┬─────────────────────┐
│ false (비활성화)    │ true (활성화)       │
├─────────────────────┼─────────────────────┤
│ VWorld API 호출     │ VWorld API 호출     │
│ 단지 정보 조회      │ 단지 정보 조회      │
│ 등기부등본 SKIP ❌  │ 등기부등본 조회 ✅  │
│ 안내 메시지 표시    │ 결과 표시           │
└─────────────────────┴─────────────────────┘
```

### 2. 비활성화 시 동작

**조회되는 정보:**
- ✅ VWorld API (좌표 정보)
- ✅ 단지 정보 (공동주택인 경우)
- ✅ 공인중개사 찾기

**조회 안 되는 정보:**
- ❌ 등기부등본 (건물/토지 정보)
- ❌ 소유자 정보
- ❌ 권리사항 (저당권 등)

---

## 🎨 UI 변경사항

### ❌ 비활성화 시 표시되는 메시지

```
┌─────────────────────────────────────┐
│  🚧                                  │
│  등기부등본 기능 점검 중             │
│                                      │
│  현재 등기부등본 조회 기능은         │
│  점검 중입니다.                      │
│  빠른 시일 내에 정상화하도록         │
│  하겠습니다.                         │
│                                      │
│  ℹ️  단지 정보와 공인중개사 찾기는   │
│     정상 이용 가능합니다             │
└─────────────────────────────────────┘
```

**디자인:**
- 🟠 주황색 경고 스타일
- 🚧 공사 중 아이콘 (`Icons.construction_rounded`)
- 💬 사용 가능한 기능 안내 (단지 정보, 공인중개사 찾기)

### ✅ 활성화 시 (기존 동작)

- 등기부등본 조회 결과 카드 표시
- 소유자 정보 표시
- 건물/토지 상세 정보 표시
- 권리사항 표시

---

## 📋 코드 변경 상세

### 1. 비활성화 플래그 추가 (Line 752)

```dart
const bool isRegisterFeatureEnabled = false;
```

### 2. 비활성화 처리 로직 (Line 785-796)

```dart
// ========================================
// 🔴 등기부등본 기능 비활성화 처리
// ========================================
if (!isRegisterFeatureEnabled) {
  setState(() {
    isRegisterLoading = false;
    registerError = null;
    registerResult = null;
    // 비활성화 상태 표시용
  });
  return; // API 호출하지 않고 종료
}
```

**핵심 로직:**
- VWorld API와 단지 정보는 먼저 조회
- 플래그가 `false`면 등기부등본 API 호출 전에 `return`
- `registerResult`를 `null`로 유지 → UI에서 안내 메시지 표시

### 3. UI 메시지 변경 (Line 1308-1385)

**Before:** 로그인 여부에 따라 다른 메시지
```dart
// 로그인하지 않은 경우 안내 메시지
if (!isLoggedIn && hasAttemptedSearch && registerResult == null)
  // "등기부등본은 로그인 후에 확인 가능합니다"
```

**After:** 비활성화 시 공통 메시지
```dart
// 등기부등본 기능 비활성화 안내 메시지
if (hasAttemptedSearch && registerResult == null)
  // "등기부등본 기능 점검 중"
```

---

## ✅ 정상 작동 확인 체크리스트

### 비활성화 상태 테스트

- [ ] 주소 검색 정상 동작
- [ ] "조회하기" 버튼 클릭 가능
- [ ] VWorld API 호출 (공인중개사 찾기 가능)
- [ ] 단지 정보 조회 (공동주택인 경우)
- [ ] 등기부등본 조회 **안 됨** (의도된 동작)
- [ ] "등기부등본 기능 점검 중" 메시지 표시
- [ ] 공인중개사 찾기 버튼 정상 동작

### 활성화 상태 테스트

- [ ] `isRegisterFeatureEnabled = true` 변경
- [ ] 앱 재시작
- [ ] 등기부등본 조회 정상 동작
- [ ] 소유자 정보 표시
- [ ] 건물/토지 정보 표시

---

## 🔒 보안 고려사항

### 현재 상태
- ✅ 등기부등본 API 호출 차단
- ✅ 민감 정보 노출 방지
- ✅ 사용자에게 명확한 안내

### 주의사항
- 📌 VWorld API는 계속 호출됨 (공인중개사 찾기 필요)
- 📌 단지 정보는 공개 정보이므로 계속 조회
- 📌 등기부등본만 선택적 비활성화

---

## 📊 API 호출 비교

| API | 비활성화 시 | 활성화 시 |
|-----|------------|----------|
| 주소 검색 (Juso API) | ✅ 호출 | ✅ 호출 |
| VWorld (좌표) | ✅ 호출 | ✅ 호출 |
| 단지 정보 (data.go.kr) | ✅ 호출 | ✅ 호출 |
| **등기부등본 (CODEF)** | ❌ **차단** | ✅ 호출 |

---

## 🔄 재활성화 절차

### 1단계: 플래그 변경
```dart
// lib/screens/home_page.dart Line 752
const bool isRegisterFeatureEnabled = true; // false → true
```

### 2단계: 테스트
1. 주소 검색
2. "조회하기" 버튼 클릭
3. 등기부등본 결과 확인
4. 소유자 정보 확인

### 3단계: 배포
- Hot Reload로는 `const` 변경 반영 안됨
- **앱 재시작 필수** (Stop & Run)
- 또는 웹 빌드 재실행

---

## 📝 관련 코드 위치

### 주요 파일
```
lib/screens/home_page.dart
├── Line 752: isRegisterFeatureEnabled 플래그
├── Line 785-796: 비활성화 로직
└── Line 1308-1385: UI 메시지
```

### 연관 기능
```
lib/api_request/register_service.dart
├── getRealEstateRegister() - 등기부등본 API 호출
└── 현재 호출되지 않음 (비활성화)

lib/utils/current_state_parser.dart
├── parseCurrentState() - 등기부등본 파싱
└── 현재 사용되지 않음 (비활성화)
```

---

## 🐛 트러블슈팅

### Q1. 플래그를 `true`로 바꿨는데 여전히 비활성화?
**A:** `const` 변수는 Hot Reload로 변경 안됨. 앱 재시작 필요.

```bash
flutter run  # 완전 재시작
```

### Q2. "조회하기" 버튼이 안 보여요
**A:** 주소를 먼저 선택해야 합니다.
1. 주소 검색
2. 결과 클릭
3. "조회하기" 버튼 표시됨

### Q3. 단지 정보도 안 나와요
**A:** 공동주택이 아니거나 데이터가 없을 수 있습니다.
- 아파트, 연립주택: 표시됨
- 단독주택, 상가: 표시 안됨 (정상)

### Q4. 공인중개사 찾기가 안 돼요
**A:** VWorld 좌표 조회가 실패했을 수 있습니다.
- 콘솔에서 "VWorld API 오류" 확인
- 유효한 주소인지 확인

---

## 📌 결론

### 비활성화 완료 ✅
- 등기부등본 조회 API 호출 차단
- 사용자에게 점검 중 안내 메시지
- 다른 기능(단지 정보, 공인중개사)은 정상 동작

### 재활성화 방법 ✅
```dart
const bool isRegisterFeatureEnabled = true;
```
한 줄만 변경하면 즉시 활성화 가능

### 사용자 영향 📊
- ✅ 주소 검색 가능
- ✅ 단지 정보 확인 가능
- ✅ 공인중개사 찾기 가능
- ❌ 등기부등본만 일시 중단

---

**작성자:** AI Assistant  
**문서 버전:** 1.0.0  
**최종 수정일:** 2024-11-01

